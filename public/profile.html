<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>ä½¿ç”¨è€…å¸³æˆ¶è³‡æ–™</title>

<style>
body {
  font-family: sans-serif;
  background: #f8f9fa;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 50px;
}
.profile-card {
  background: white;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  width: 350px;
  text-align: center;
}
.avatar-box {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: #eee;
  margin: 0 auto 15px;
  overflow: hidden;
  border: 2px solid #007bff;
  cursor: pointer;
}
.avatar-box img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.info-group {
  text-align: left;
  margin-top: 20px;
}
label {
  font-size: 12px;
  color: #666;
  font-weight: bold;
}
.value {
  font-size: 16px;
  margin-bottom: 15px;
  color: #333;
}
button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}
.btn-gray { background: #eee; }
.btn-main { background: #0984e3; color: white; }
.btn-danger { background: #ff7675; color: white; }

.admin-link {
  margin-bottom: 15px;
  background: #6c5ce7;
  color: white;
}
.toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 15px;
}
</style>
</head>

<body>

<a href="admin.html" id="admin-btn" class="admin-link" style="display:none;">ğŸ›  ç®¡ç†å“¡å¾Œå°</a>

<div class="profile-card">

  <!-- å¤§é ­è²¼ -->
  <div class="avatar-box" id="avatar-click-zone">
    <img id="preview" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=">
  </div>
  <input type="file" id="fileInput" hidden accept="image/*">
  <p style="font-size:12px;color:#0984e3;">é»æ“Šæ›´æ›å¤§é ­è²¼</p>

  <!-- åŸºæœ¬è³‡è¨Š -->
  <div class="info-group">
    <label>é›»å­éƒµä»¶</label>
    <div class="value" id="email-display">---</div>

    <label>å®‰å…¨ç‹€æ…‹</label>
    <div class="value" style="color:green;">â— å·²é€šéèº«åˆ†é©—è­‰</div>

    <label>æœ€è¿‘ç™»å…¥</label>
    <div class="value" id="last-login">---</div>
  </div>

  <!-- åŠŸèƒ½å€ -->
  <div class="toggle">
    <input type="checkbox" id="darkToggle">
    <span>ğŸŒ™ æ·±è‰²æ¨¡å¼</span>
  </div>

  <button class="btn-gray" id="logout-btn">ğŸšª ç™»å‡ºå¸³è™Ÿ</button>
  <button class="btn-danger" id="clear-btn">âš ï¸ æ¸…é™¤æœ¬æ©Ÿå¸³æˆ¶è³‡æ–™</button>
  <button class="btn-gray" id="back-to-main">è¿”å›ä¸»é </button>

</div>

<script>
document.addEventListener('DOMContentLoaded', () => {

  const fileInput = document.getElementById('fileInput');
  const preview = document.getElementById('preview');
  const avatarZone = document.getElementById('avatar-click-zone');

  /* ===== åˆå§‹åŒ–å¸³æˆ¶è³‡è¨Š ===== */
  document.getElementById('email-display').innerText =
    localStorage.getItem('userEmail') || 'æœªç™»å…¥';

  document.getElementById('last-login').innerText =
    new Date().toLocaleString('zh-TW');

  if (localStorage.getItem('userAvatar')) {
    preview.src = localStorage.getItem('userAvatar');
  }

  /* ===== ç®¡ç†å“¡é¡¯ç¤º ===== */
  if (localStorage.getItem('isAdmin') === 'true') {
    document.getElementById('admin-btn').style.display = 'block';
  }

  /* ===== å¤§é ­è²¼ä¸Šå‚³ ===== */
  avatarZone.onclick = () => fileInput.click();
  fileInput.onchange = e => {
    const file = e.target.files[0];
    if (!file || file.size > 2 * 1024 * 1024) {
      alert('åœ–ç‰‡éœ€å°æ–¼ 2MB');
      return;
    }
    const reader = new FileReader();
    reader.onload = ev => {
      preview.src = ev.target.result;
      localStorage.setItem('userAvatar', ev.target.result);
    };
    reader.readAsDataURL(file);
  };

  /* ===== æ·±è‰²æ¨¡å¼ ===== */
  const toggle = document.getElementById('darkToggle');
  if (localStorage.getItem('darkMode') === 'on') {
    document.body.style.background = '#2d3436';
    document.querySelector('.profile-card').style.background = '#353b48';
    document.querySelector('.profile-card').style.color = '#f5f6fa';
    toggle.checked = true;
  }

  toggle.onchange = () => {
    if (toggle.checked) {
      localStorage.setItem('darkMode', 'on');
    } else {
      localStorage.removeItem('darkMode');
    }
    location.reload();
  };

  /* ===== ç™»å‡º ===== */
  document.getElementById('logout-btn').onclick = () => {
    localStorage.removeItem('auth_token');
    location.href = 'index.html';
  };

  /* ===== æ¸…é™¤å¸³æˆ¶ ===== */
  document.getElementById('clear-btn').onclick = () => {
    if (confirm('ç¢ºå®šæ¸…é™¤æ‰€æœ‰æœ¬æ©Ÿå¸³æˆ¶è³‡æ–™ï¼Ÿ')) {
      localStorage.clear();
      location.href = 'index.html';
    }
  };

  /* ===== è¿”å›ä¸»é  ===== */
  document.getElementById('back-to-main').onclick = () => {
    location.href = 'main.html';
  };
});
</script>

</body>
</html>
